@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
@{
    //修改會員資料
    var MInvestYear = @Context.Session.GetString("MinvestYear")!;
    var Mlevel = @Context.Session.GetString("Mlevel")!;
}

<h1 class="text-">會員功能-主頁</h1>

<div class="row">
    <div class="col-md-4">
        <button id="showMemberIndex">回到會員頁</button><br>
        <button id="showRevise">修改個人資料</button><br>
        <button id="showFavoritesPage">我的收藏</button><br>
        <button id="showPredictFunc">我要預測</button><br>
        <button id="showHistoryPage">歷史預測結果</button><br>
    </div>
    <div class="col-md-8">
        @* Session 傳值 *@
        <div style="background-color:lightpink">
            <p> <b>Session傳值1:</b> @Context.Session.GetString("MID") </p><br>
            <p> <b>Session傳值2:</b> @Context.Session.GetString("MEmail")</p>
            <p> <b>Session傳值3:</b> @Context.Session.GetString("Mlevel")</p>
            <p> <b>Session傳值4:</b> @MInvestYear</p>
        </div>

        <div id="beforeLog">
            <b>請先登入會員</b>
        </div>

        <div id="afterLog">

            @* 1.會員主頁 *@
            <div id="MemberIndex">

                <div>
                    顯示會員的歷史預測結果圖1
                </div>
                <div>
                    顯示會員的歷史預測結果圖2
                </div>
                <div>
                    顯示會員的歷史預測結果圖3
                </div>

            </div>

            @* 2.修改個人資料 *@
            <div id="Revise">

                <div>
                    <label for="Account">帳號:</label>
                    <label>@Context.Session.GetString("MaccoMnt")</label>
                </div>
                <div>
                    <label for="Password">密碼:</label>
                    <input type="password" pattern="" size="20" minlength="20" name="MPassword1" id="Password1" title="至少包含一個特殊符號，且長度須超過8碼" value="">
                </div>
                <div>
                    <label for="Password">請再次輸入密碼:</label>
                    <input type="password" pattern="" size="20" minlength="20" name="MPassword2" id="Password2" title="請再輸入您剛才設定的密碼" value="">
                    @* 再次輸入密碼不同時，顯示提示字 *@
                    <div id="pwdnoteword"><p style="color:red; ">您輸入的密碼不相同</p></div>
                </div>

                <label for="Email">信箱:</label>
                <input type="email" pattern="" name="MEmail" id="Email" value="" placeholder="@Context.Session.GetString("MEmail")">
                <br>

                <label for="UserName">姓名:</label>
                <input type="text" name="MTrueName" id="UserName" value="" placeholder="@Context.Session.GetString("MtrueName")">
                <br>

                <label for="Birthday">生日:</label>
                <label>@Context.Session.GetString("Mbirthday")</label>
                <br>

                <label for="MGender">性別:</label>
                <label>@Context.Session.GetString("Mgender")</label>
                <br>

                <label for="MInvestYear">您的投資年數:</label>
                <select name="MInvestYear" id="InvestYear">
                    <option value="1">未滿1年</option>
                    <option value="1-3">1-3年</option>
                    <option value="3-5">3-5年</option>
                    <option value="5">5年以上</option>
                </select>
                <br>

                <label for="MLevel">會員等級:</label>
                <select name="MLevel" id="MLevel" size="1">
                    <option value="一般會員">一般會員</option>
                    <option value="高級會員">高級會員</option>
                </select>
                <br>

                <button id="ReviseData">修改資料</button>
                <button id="Reset">取消</button>

            </div>

            @* 3.我的收藏 *@
            <div id="FavoritesPage">

                我的收藏

            </div>

            @* 4.我要預測 *@
            <div id="PredictFunc">

                跳轉到我要預測

            </div>

            @* 5.歷史預測結果 *@
            <div id="HistoryPage">

                歷史預測結果

            </div>

        </div>

    </div>
</div>

<script>
    //判斷會員是否登入
    var MID = "@Context.Session.GetString("MID")"
    if (MID == '') {
        $('#beforeLog').show();
        $('#afterLog').hide();
    } else {
        $('#beforeLog').hide();
        $('#afterLog').show();
    }
    console.log("顯示MID:"+MID);
 

    // 隱藏不同按鈕顯示的畫面
    $('#Revise').hide();
    $('#FavoritesPage').hide();
    $('#PredictFunc').hide();
    $('#HistoryPage').hide();

    // 重新設定密碼的提示字
    $('#pwdnoteword').hide();

    $(function () {
        // 1.點擊回到會員頁
        $('#showMemberIndex').on("click", function () {
            $('#Revise').hide();
            $('#FavoritesPage').hide();
            $('#PredictFunc').hide();
            $('#HistoryPage').hide();
            $('#MemberIndex').show();

        })

        // 2.點擊修改個人資料
        $('#showRevise').on("click", function () {
            $('#Revise').show();
            $('#FavoritesPage').hide();
            $('#PredictFunc').hide();
            $('#HistoryPage').hide();
            $('#MemberIndex').hide();

            //檢查兩次輸入的密碼是否一致
            $('#Password2').on("change", function () {
                var MPassword1 = $('#Password1').val();
                var MPassword2 = $('#Password2').val();
                if (MPassword1 != MPassword2) {
                    $('#pwdnoteword').show();
                }
                else {
                    $('#pwdnoteword').hide();
                    console.log("ok");
                }
                if (MPassword2 == "") {
                    $('#pwdnoteword').hide();
                }
            })

            switch ("@MInvestYear") {

                case "1":
                    $("#InvestYear").val("1");
                    // console.log("1")
                    // console.log("123")
                    break;
                case "2":
                    $("#InvestYear").val("1-3");
                    // console.log("2")
                    break;
                case "3":
                    $("#InvestYear").val("3-5");
                    // console.log("3")
                    break;
                case "5":
                    $("#InvestYear option[value='5']").prop("selected", true);
                    // console.log("5")
                    break;
                default:
                    console.log("error");
                    break;
            }
            var encodedString = "@Mlevel"; // 將 @Mlevel 的值放在這裡
            var tempElement = document.createElement("div");
            tempElement.innerHTML = encodedString;
            var decodedString = tempElement.innerText || tempElement.textContent;
            switch (decodedString) {

                case "一般會員":
                    $("#MLevel").val("一般會員");
                    break;
                case "高級會員":
                    $("#MLevel").val("高級會員");
                    break;
                default:
                    break;
            }

        })
        // 3.點擊我的收藏
        $('#showFavoritesPage').on("click", function () {
            $('#Revise').hide();
            $('#FavoritesPage').show();
            $('#PredictFunc').hide();
            $('#HistoryPage').hide();
            $('#MemberIndex').hide();

        })

        // 4.點擊我要預測
        $('#showPredictFunc').on("click", function () {
            $('#Revise').hide();
            $('#FavoritesPage').hide();
            $('#PredictFunc').show();
            $('#HistoryPage').hide();
            $('#MemberIndex').hide();

        })

        // 5.點擊歷史預測結果
        $('#showHistoryPage').on("click", function () {
            $('#Revise').hide();
            $('#FavoritesPage').hide();
            $('#PredictFunc').hide();
            $('#HistoryPage').show();
            $('#MemberIndex').hide();

        })
    })

</script>




